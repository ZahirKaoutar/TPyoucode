#include <stdio.h>
#include <string.h>

struct Joueur {
    int id;
    char nom[100];
    int numeroMaillot;
    char poste[20];
    int age;
    int buts;
};

struct Joueur tab[100];

int nmr = 0;  
char roles[4][20] = {"gardiant", "défenseur", "milieu", "attaquant"};

void Ajoutfois() {
    char role[20];
    printf("Entrer le nom: ");
    scanf(" %[^\n]", tab[nmr].nom);

    printf("Numéro Maillot: ");
    scanf("%d", &tab[nmr].numeroMaillot);

    printf("Age: ");
    scanf("%d", &tab[nmr].age);

    printf("Buts: ");
    scanf("%d", &tab[nmr].buts);

    printf("Entrer le rôle de joueur ('gardiant','défenseur', 'milieu','attaquant'): ");
    scanf(" %[^\n]", role);

    int valide = 0;
    for (int i = 0; i < 4; i++) {
        if (strcmp(role, roles[i]) == 0) {
            valide = 1;
            strcpy(tab[nmr].poste, role);
            break;
        }
    }

    if (!valide) {
        printf("Erreur : il faut entrer un des rôles suivants : gardiant, défenseur, milieu, attaquant\n");
        scanf(" %[^\n]", role);
        return;
    }

    tab[nmr].id = nmr + 1;
    nmr++;
}

void Ajouterjoueur() {
    char choix[20];
    int nmbjou;

    do {
        printf("Entrer choix (un / plusieurs / stop) : ");
        scanf(" %19[^\n]", choix);

        if (strcmp(choix, "un") == 0) {
            Ajoutfois();
        } else if (strcmp(choix, "plusieurs") == 0) {
            printf("Combien de joueurs voulez-vous ajouter en une fois ? ");
            scanf("%d", &nmbjou);

            while (nmbjou <= 0 || nmbjou > 100 - nmr) {
                printf("Le nombre doit être positif et <= %d : ", 100 - nmr);
                scanf("%d", &nmbjou);
            }

            for (int i = 0; i < nmbjou; i++) {
                Ajoutfois();

            }
        }
    } while (nmr < 100 && strcmp(choix, "stop") != 0);
}


void Affichefois(struct Joueur J){
    
            printf("id  %d\n",J.id);
            printf("le nom %s\n",J.nom);
            printf("le numeroMaillot  %d\n",J.numeroMaillot);
             printf("le post %s\n",J.poste);
          
            printf("age %d\n",J.age);
             
            printf("buts%d\n",J.buts);
            
    
}










void trierParNom() {
    struct Joueur temp;
    for (int i = 0; i < nmr - 1; i++) {
        for (int j = i + 1; j < nmr; j++) {
            if (strcmp(tab[i].nom, tab[j].nom) > 0) {
                temp = tab[i];
                tab[i] = tab[j];
                tab[j] = temp;
            }
        }
    }
    
    for(int i=0;i<nmr;i++){
        Affichefois(tab[i]);
    }
}


void trierParAge() {
    struct Joueur temp;
    for (int i = 0; i < nmr - 1; i++) {
        for (int j = i + 1; j < nmr; j++) {
            if (tab[i].age > tab[j].age) {
                temp = tab[i];
                tab[i] = tab[j];
                tab[j] = temp;
            }
        }
    }
     for(int i=0;i<nmr;i++){
        Affichefois(tab[i]);
    }
}
// void Affichepost() {
//     struct Joueur group[100];
//     int countgrp=0;
//     int trouv=0;
//     for(int i=0;i<nmr-1;i++){
//         for(int j=i+1;j<nmr;j++){
//             if(strcmp(tab[i].poste,tab[j].poste)==0){
//                 trouv=1;
//                   group[countgrp] = tab[j];  
                 
//                 countgrp++;


//             }
            
//         }
        
//     }
    
   
    
//     if(trouv==1){
        
//         for(int i=0;i<countgrp;i++){
//             Affichefois(group[i]);
//         }

//     }
//         for(int i=0;i<nmr;i++){  
//             for(int j=0;j<countgrp;j++){
//                 if(strcmp(tab[i].poste,group[j].poste)==0){
//                   trouv=1;
//                   break;
//                 }
        
//                 if(!trouv){
//                     printf("ce role trouve une seul fois %s",tab[i].poste);
//                 Affichefois(tab[i])
//                 }
//             }
//         }    
// }
void Affichepost() {
//     int roleCount[4] = {0}; 
//     int i, j;

   
//     for (i = 0; i < nmr; i++) {
//         for (j = 0; j < 4; j++) {
//             if (strcmp(tab[i].poste, roles[j]) == 0) {
//                 roleCount[j]++;
//                 break;
//             }
//         }
//     }

//   for (j = 0; j < 4; j++) {
//     printf("\n le rôle '%s' (apparu %d fois) :\n", roles[j], roleCount[j]);
//     for (i = 0; i < nmr; i++) {
//         if (strcmp(tab[i].poste, roles[j]) == 0) {
//             Affichefois(tab[i]);
//         }
//     }
// }




 struct Joueur temp;
    for (int i = 0; i < nmr - 1; i++) {
        for (int j = i + 1; j < nmr; j++) {
            if (strcmp(tab[i].poste, tab[j].poste) > 0) {
                temp = tab[i];
                tab[i] = tab[j];
                tab[j] = temp;
            }
        }
    }
    int inexdeb=0;
    int count=1;
    for(int i=0;i<nmr-1;i++){
        if(strcmp(tab[i].poste, tab[i+1].poste)==0){
            count++;
            
        }else{
            printf("le role %s trouve %d ",tab[i].poste,count);
            for(int j=inexdeb;j<=i;j++){
                Affichefois(tab[j]);
            }
            count=1;
            inexdeb=i+1;
            
        }
    }
    //pour dernier poste car table il stop à avant  nmr-1
    printf("\nLe rôle '%s' est trouvé %d fois :\n", tab[nmr - 1].poste, count);
        for (int j = inexdeb; j < nmr; j++) {
            Affichefois(tab[j]);
        }



}

    
void AfficherJoueur() {
   int choixAff;
    printf("1  triage de nom\n2 triage de age\n3 Affiche poste \n");
    scanf("%d", &choixAff);
    getchar();
    switch(choixAff){
        case 1:
            trierParNom();
            break;
        case 2:
            trierParAge();
            break;
        case 3:
             Affichepost();
            
            break;


    }
        
      
}
void recherchId(){
    int trouv=0;
    int id;
     do{
            printf("entrer le id");
            scanf("%d",&id);
            for(int i=0;i<nmr;i++){
                if(tab[i].id==id){
                    trouv=1;
                    Affichefois(tab[i]);
                    break;
                }

            }
            


     }while(trouv!=1);

}

void supprime(){
    recherchId();
    printf("bonne suppression\n");
    for(int i=0;i<nmr;i++)
        Affichefois(tab[i]);


}
void recherchnom(){
    char searchnom[20];
    int trouv=0;
    struct Joueurj;
     do{
            printf("entrer le nom de search");
            scanf("%99s",searchnom);
            getchar();
            for(int i=0;i<nmr;i++){
                if(strcmp(searchnom,tab[i].nom)==0){
                    trouv=1;
                      j=Affichefois(tab[i]);
                    
                }

            }
            return j;
           

     }while(trouv!=1);}


void Recherche(){
    int choixsearch;
    printf("1 recherch nom \n2recherche par id");
    scanf("%d",&choixsearch);
    getchar();
    switch(choixsearch){
        case 1:
            recherchnom();
            break;
        case 2:
            recherchId();
            break;
        default:
            printf("");
    }
   
}


void modpost(){
    char nvlpost[20];
      struct Joueur j=recherchnom();
      printf("entrer la nouvelle valeur  post");
        scanf("%s",nvlpost);
         strcpy(j.poste,nvlpost);
         Affichefois(Joueur j);
                        
      
}

    
void modage(){
   int nvlage;
      struct Joueur j=recherchnom();
      printf("entrer la nouvelle valeur  age");
        scanf("%d",nvlage);
         strcpy(j.poste,nvlage);
         Affichefois(Joueur j);
                        
      
}
void modbuts(){
   int nvlbuts;
      struct Joueur j=recherchnom();
      printf("entrer la nouvelle valeur  buts");
        scanf("%d",nvlbuts);
         strcpy(j.poste,nvlage);
         Affichefois(Joueur j);
                        
      
}
  
void Modifier(){
    int choixMod;
    printf("1 modifier post \n2 modifier par buts\n3 modifier  age");
    scanf("%d",&choixMod);
    getchar();
    switch(choixMod){
        case 1:
            modchpost();
            break;
        case 2:
            modbuts();
            break;
        case 2:
            modage();
            break;
        default:
            printf("");
    }
    
}
 
   
 

int main() {
    int choixMenu = 1;
    int nmb;

    do {
        printf("Choisir le nombre que vous voulez:\n 1 pour ajouter\n 2 pour afficher\n 3 pour Suppression\n 4 pour search\n 5 pour rechercher\n");
        scanf("%d", &nmb);

        switch (nmb) {
            case 1:
                Ajouterjoueur();
                break;
            case 2:
                AfficherJoueur();
                
                break;
            case 3:
                supprime();
               
                
                break;
            case 4:
                Recherche();
                break;
            case 5:
                Modifier();
                
               
                break;
            default:
            printf(" ");
               
        }

        printf("Choisir 1 pour afficher le menu, 0 pour sortir : ");
        scanf("%d", &choixMenu);

    } while (choixMenu == 1);

    return 0;
}
